<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0"/>
  <title> Catálogo de Juegos </title>

  <!-- CSS  -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection"/>
  <link href="css/style.css" type="text/css" rel="stylesheet" media="screen,projection"/>
  <link rel="shortcut icon" href="https://img.icons8.com/ios-filled/100/ps-controller.png" type="image/x-icon">
</head>
<body>
  <div class="section no-pad-bot  indigo darken-4" id="index-banner">
    <div class="container indigo darken-4">
      <br><br>
      <h1 class="header center orange-text indigo darken-4">Catálogo de Juegos</h1>
      <div class="row center">
        <h5 class="header col s12 light orange-text">Explora nuestro catálogo de juegos</h5>
      </div>
      <div class="row center">
        <a href="#form-section" id="download-button" class="btn-large waves-effect waves-light orange">Iniciar</a>
      </div>
      <br><br>

    </div>
  </div>

  <div class="container">
    <h1 class="center"> Agrega Juegos al Catálogo </h1>
    <div class="section" id="form-section">     
        <div class="row">          
            <form class="col s12">
              <div class="row">
                <div class="input-field col s6">                  
                  <input id="title" type="text" autofocus>
                  <label for="title">Title</label>
                </div>
                <div class="input-field col s6">
                  <input id="genre" type="text">
                  <label for="genre">Genre</label>
                </div>
              </div>            
              <div class="row">
                <div class="input-field col s12">
                  <input id="developer" type="text">
                  <label for="developer">Developer</label>
                </div>
              </div>
              <div class="row">
                <div class="input-field col s12">
                  <input id="platforms" type="text">
                  <label for="platforms">Platforms</label>
                </div>
              </div>
              <div class="row">
                <div class="input-field col s6">
                  <input id="rating" type="number">
                  <label for="rating">Rating</label>
                </div>
              </div> 
              <div class="row">
                <div class="input-field col s6">
                  <input id="release_date" type="date">
                  <label for="release_date">Release Date</label>
                </div>
              </div> 
              <div class="row">
                <div class="input-field col s12">
                  <textarea id="reviews" class="materialize-textarea"></textarea>
                  <label for="reviews">Reviews</label>
                </div>
              </div>                            
              <button id="insert" class="btn waves-effect waves-light">Insertar</button>
              <button id="read" class="btn waves-effect waves-light"> Leer </button>
              <button id="update" class="btn waves-effect waves-light"> Actualizar </button>
              <button id="delete" class="btn waves-effect waves-light"> Eliminar </button>

            </form>
          </div>
    <br><br>
  </div>
</div>

<div class="container" id="gameContainer">
  
</div>



  <footer class="page-footer blue darken-4 fixed-bottom">
    <div class="container">
      <div class="row">
        <div class="col l6 s12">
          <h5 class="white-text">Descripción</h5>
          <p class="grey-text text-lighten-4"> Un CRUD con un Catálogo de Juegos</p>
        </div>
        <div class="col l3 s12">
          <h5 class="white-text">CRUD con Firebase</h5>
          <p> Este sitio web esta realizado para hacer un CRUD con Firebase </p>
        </div>
      </div>
    </div>
    <div class="footer-copyright">
      <div class="container">
        <p class="white-text"> Hecho por Samuel Fuentes y Elias Sosa</p>
      </div>
    </div>
  </footer>


<script type="module">
  // Import the functions you need from the SDKs you need
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
import { getFirestore, setDoc, getDocs, addDoc, collection, updateDoc, deleteDoc, doc} from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";


  // Web app's firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyC99XXYmK1D1QUzYMhXFp8K6-b39Tmsw8M",
    authDomain: "db-project-b1376.firebaseapp.com",
    databaseURL: "https://db-project-b1376-default-rtdb.firebaseio.com",
    projectId: "db-project-b1376",
    storageBucket: "db-project-b1376.appspot.com",
    messagingSenderId: "833061070587",
    appId: "1:833061070587:web:eea62e5cd01241b79e325e",
    measurementId: "G-71SQMRT1CK"
  };

  // Initialize Firebase
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

var titleV, genreV, developerV, platformsV, ratingV, releaseDateV, reviewsV
const gameContainer = document.getElementById("gameContainer") 
const addBtn = document.getElementById("insert");

function readForm () {
    titleV = document.getElementById("title").value;
    genreV = document.getElementById("genre").value;
    developerV = document.getElementById ("developer").value
    platformsV = document.getElementById ("platforms").value
    ratingV = document.getElementById ("rating").value
    releaseDateV = document.getElementById ("release_date").value
    reviewsV = document.getElementById ("reviews").value       
    console.log (titleV, genreV, developerV, platformsV, ratingV, releaseDateV, reviewsV)
}

const gamesCollection = collection(db, 'games');
const querySnapshot = await getDocs(gamesCollection);

querySnapshot.forEach((doc) => {
  console.log(doc.id, " => ", doc.data());
  gameContainer.innerHTML += `
  <div class="row">
  <div class="col s12 m6">
    <div class="card purple darken-4">
      <div class="card-stacked">
        <div class="card-content white-text">
          <span class="card-title">${doc.data().title}</span>
          <p><strong>Genre:</strong> ${doc.data().genre}</p>
          <p><strong>Developer:</strong> ${doc.data().developer}</p>
          <p><strong>Platforms:</strong> ${doc.data().platforms}</p>
          <p><strong>Rating:</strong> ${doc.data().rating}</p>
          <p><strong>Release Date:</strong> ${doc.data().releaseDate}</p>
          <p><strong>Reviews:</strong> ${doc.data().reviews}</p>
          <br>          
          <a class="waves-effect waves-light btn  purple darken-1"  style="margin-right: 10px;">Editar</a>
          <a class="waves-effect waves-light btn  purple darken-1">Actualizar</a>
        </div>
      </div>
    </div>
  </div>
</div>
  `
});


addBtn.addEventListener("click", async (e) =>  {
  e.preventDefault();
  readForm();

  await addDoc(collection(db, "games"), {
    title: titleV,
    genre: genreV,
    developer: developerV,
    platforms: platformsV,
    rating: ratingV,
    releaseDate: releaseDateV,
    reviews: reviewsV
});


  alert("Game added successfully");

  addBtn.reset();
  title.focus();

})

document.getElementById("read").onclick = function (e) {  
  readForm();

  const docRef = doc(db, "games", 'QlIgxnWTpOowE51I5e41');
  const docSnap = getDoc(docRef);

if (docSnap.exists()) {
  console.log("Document data:", docSnap.data());
} else {
  // docSnap.data() will be undefined in this case
  console.log("No such document!");
}

  alert("Game read successfully");
}



document.getElementById("update").onclick = function (e) {  
  readForm();

  // Get a reference to the specific document you want to update
  const docRef = doc(db, "games", 'QlIgxnWTpOowE51I5e41');

  // Use the updateDoc function to update the document
  updateDoc(docRef, {
    title: titleV,
    genre: genreV,
    developer: developerV,
    platforms: platformsV,
    rating: ratingV,
    releaseDate: releaseDateV,
    reviews: reviewsV
  });

  alert("Game updated successfully");
}


document.getElementById("delete").onclick = function (e) {
  e.preventDefault();

  deleteDoc(doc(db, "games", "p7Fezmcy8EVQt7S9a4HX"));
  
  alert("Game deleted successfully");

};




</script>

  <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <script src="js/materialize.js"></script>
  <script src="js/init.js"></script>



  </body>
</html>
